# 📘 프로세스 간 통신(IPC, Inter-Process Communication)

#### ✅ 다른 프로세스 간에 데이터를 전송하거나 상호작용하기 위한 메커니즘

#### ✅ 다양한 IPC 기법이 존재하며, 각각의 기법은 다른 상황이나 요구에 맞게 선택되어 사용된다.

#### ✅ 멀티 스레드와 함께 멀티 프로세스의 데이터 전송 기술

---

## 0. IPC 주요 목적

#### 1. 데이터 교환

- 서로 다른 프로세스 간에 데이터를 주고 받기 위해 사용된다.

#### 2. 자원 공유

- 파일, 메모리 등 자원을 여러 프로세스가 동시에 사용할 수 있게 한다.

#### 3. 동기화

- 여러 프로세스가 **동시에 실행될 때** 충돌을 방지하고 **정확한 동작을 보장**하기 위해 사용

#### 4. 프로세스 제어

- 한 프로세스가 다른 프로세스의 실행을 제어하거나 멈추게 할 수 있다.

---

## 1. IPC 주요 기법

### 1️⃣ 파이프

- 하나의 컴퓨터 안에서 실행되는 프로세스 간에 발생하는 통신
- 한 프로세스가 데이터를 쓰고 다른 프로세스가 그 데이터를 읽을 수 있는 단방향 통신
- 주로 부모 프로세스와 자식 프로세스 사이에서 사용 된다.
- 두 프로세스는 같은 호스트 내에서 동작해야 한다.

#### 특징

1. **단방향 통신**

   - 파이프는 단방향 통신 메커니즘이므로 데이터의 흐름은 한 방향이다.
   - 데이터를 보내는 쪽과 받는 쪽이 분리되어 있다.

2. **부모-자식 프로세스 간 통신**

   - 부모 프로세스가 파이프를 생성하고, 자식 프로세스에서 이를 통해 데이터를 읽거나 쓸 수 있다.

3. **파일 기반 통신**

   - 파이프는 **파일처럼 취급**되기 때문에 *파일 디스크립터(File Descriptor)*를 통해 열고 닫을 수 있다.
   - 파이프의 읽기 측과 쓰기 측 **각각**에 대한 파일 디스크립터가 필요하다.

4. **단순한 데이터 전달**
   - 파이프는 단순히 데이터를 전달하기 위한 용도로 사용
   - **복잡한 구조의 데이터 전송은 어려움**

#### 💡 익명 파이프

> - 프로세스 사이의 FIFO 기반의 통신 채널을 만들어 통신하는 것을 의미

#### 💡 네임드 파이프

> - 익명 파이프에서 확장된 개념으로, 부모 - 자식 프로세스 뿐만 아니라 다른 네트워크 상에서도 통신할 수 있는 파이프를 의미

- 보통 서버용 파이프, 클라이언트용 파이프를 구분해서 동작

#### 🔎 익명 파이프와 네임드 파이프의 차이

> - 익명 파이프 : 부모-자식 프로세스간에서만 사용되며 네트워크 간 통신에서 사용 X.
> - 네임드 파이프 : 부모-자식에서 확장되어 네트워크 간 통신에서도 사용 O

---

### 2️⃣ 메시지 큐

- 프로세스가 메시지를 생성하고 전송하여 다른 프로세스가 이를 수신하는 메커니즘
- **비동기 적으로** 데이터를 전달하므로, 데이터를 생산하는 프로세스와 데이터를 소비하는 프로세스가 실시간으로 동작하지 않아도 되는 상황에서 유용
- 사용할 데이터에 **번호**를 붙이면서 **여러 프로세스가 동시에 데이터를 쉽게 다룰 수 있다**.
- 메시지의 접근을 위해서는 **키(key)**가 필요하다

#### 특징

1. **비동기 통신**

   - Producer-Consumer 패턴을 멀티 프로세스로 활용할 때 메세지 큐를 활용
     - 데이터를 Producer가 Queue에 넣고 여러 개의 Consumer Processes가 이를 처리하는 방식

2. **메시지 지향**

   - 메시지 단위로 데이터 전달
   - 각 메시지는 데이터와 함께 메시지 식별자를 포함
   - 이를 통해 프로세스 간에 특정 형식의 메시지를 주고 받을 수 있다.

3. **버퍼링**

   - 내부적으로 버퍼를 사용하여 메시지를 저장하고 전달
   - 이를 통해 메시지 소비자가 메시지를 즉시 처리하지 않더라도 데이터의 유실이나 지연 방지 가능

4. **우선 순위**
   - 일부 메시지 큐 시스템은 메시지에 우선순위를 부여 가능
   - 이를 통해 중요한 메시지를 먼저 처리하도록 조절

---

### 3️⃣ 공유 메모리

- 여러 프로세스 간에 **메모리 영역을 공유**하여 데이터를 직접 주고 받는 메커니즘
- 이를 통해 데이터를 복사하거나 중간 매개체를 거치지 않고 **빠르게 통신 가능**

#### 특징

1. **빠른 데이터 전송**

   - 공유 메모리를 사용하면 데이터를 직접 복사하지 않고 메모리 영역을 공유하기 때문에 데이터 전송 속도가 빠르다.

2. **간단한 구현**

   - 일반적으로 메모리 맵핑(Memory Mapping) 기술을 사용하여 구현되며, 프로세스 간에 메모리를 공유하고 접근하는 것이 비교적 간단하다.

3. **동기화 필요**
   - 여러 프로세스가 공유 메모리를 동시에 접근할 때 **동기화 문제**가 발생할 수 있다.
     - 이를 해결하기 위해 **세마포어, 뮤텍스 등의 동기화 메커니즘을 사용**해야 한다.

---

### 4️⃣ 소켓

- 소켓을 사용하면 다른 컴퓨터나 같은 컴퓨터의 다른 프로세스와 데이터를 주고 받을 수 있다.
- 소켓을 이용한 통신은 **클라이언트 - 서버** 모델로 작동하며, 네트워크 상에서 데이터를 전송하고 수신하는 기능을 제공
- **네트워크 프로토콜(주로 TCP/IP)을 사용**하여 통신하는 두 프로그램 간의 연결을 가능하게 하는 엔드포인트이다.

#### 소켓 통신의 기본 원리

- **서버 소켓 생성**: 서버는 소켓을 생성하고, 특정 포트에 바인드하여 클라이언트의 연결 요청을 기다립니다.

- **클라이언트 연결 요청**: 클라이언트는 서버의 IP 주소와 포트 번호를 사용하여 서버에 연결을 시도합니다.

- **데이터 송수신**: 연결이 성립되면, 서버와 클라이언트는 소켓을 통해 데이터를 송수신할 수 있습니다.

- **연결 종료**: 데이터 전송이 완료되면, 양쪽 프로세스 모두 소켓 연결을 종료합니다.
